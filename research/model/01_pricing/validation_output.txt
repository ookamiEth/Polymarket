warning: The `tool.uv.dev-dependencies` field (used in `/home/ubuntu/Polymarket/pyproject.toml`) is deprecated and will be removed in a future release; use `dependency-groups.dev` instead
2025-10-30 06:57:58,428 - INFO - ================================================================================
2025-10-30 06:57:58,428 - INFO - XGBOOST DATA VALIDATION REPORT
2025-10-30 06:57:58,428 - INFO - ================================================================================
2025-10-30 06:57:58,428 - INFO - Report generated: 2025-10-30 06:57:58
2025-10-30 06:57:58,428 - INFO - 
2025-10-30 06:57:58,428 - INFO - 1. DATASET SIZES
2025-10-30 06:57:58,428 - INFO - --------------------------------------------------------------------------------
2025-10-30 06:57:58,481 - INFO - Total rows in dataset: 63,072,900
2025-10-30 06:57:58,522 - INFO - Training    :   15,724,800 rows ( 24.9%)
2025-10-30 06:57:58,531 - INFO - Validation  :    7,776,000 rows ( 12.3%)
2025-10-30 06:57:58,596 - INFO - Test        :   39,398,400 rows ( 62.5%)
2025-10-30 06:57:58,596 - WARNING - ⚠️  Test set is 2.5x LARGER than training set!
2025-10-30 06:57:58,596 - WARNING -     This increases overfitting risk due to regime shift.
2025-10-30 06:57:58,596 - INFO - 
2025-10-30 06:57:58,596 - INFO - 2. FEATURE ANALYSIS
2025-10-30 06:57:58,596 - INFO - --------------------------------------------------------------------------------
/home/ubuntu/Polymarket/research/model/01_pricing/test_xgboost_data_validation.py:112: PerformanceWarning: Determining the column names of a LazyFrame requires resolving its schema, which is a potentially expensive operation. Use `LazyFrame.collect_schema().names()` to get the column names without this warning.
  baseline_cols = [c for c in baseline_df.columns if c not in ["date", "symbol", "timestamp_seconds"]]
2025-10-30 06:57:58,626 - INFO - Baseline features:       33
/home/ubuntu/Polymarket/research/model/01_pricing/test_xgboost_data_validation.py:119: PerformanceWarning: Determining the column names of a LazyFrame requires resolving its schema, which is a potentially expensive operation. Use `LazyFrame.collect_schema().names()` to get the column names without this warning.
  rv_cols = [c for c in rv_df.columns if c not in ["timestamp_seconds"]]
2025-10-30 06:57:58,629 - INFO - RV features:             10
/home/ubuntu/Polymarket/research/model/01_pricing/test_xgboost_data_validation.py:129: PerformanceWarning: Determining the column names of a LazyFrame requires resolving its schema, which is a potentially expensive operation. Use `LazyFrame.collect_schema().names()` to get the column names without this warning.
  micro_cols = [c for c in micro_df.columns if c not in ["timestamp_seconds"]]
2025-10-30 06:57:58,633 - INFO - Microstructure features:  14
/home/ubuntu/Polymarket/research/model/01_pricing/test_xgboost_data_validation.py:139: PerformanceWarning: Determining the column names of a LazyFrame requires resolving its schema, which is a potentially expensive operation. Use `LazyFrame.collect_schema().names()` to get the column names without this warning.
  advanced_cols = [c for c in advanced_df.columns if c not in ["timestamp_seconds"]]
2025-10-30 06:57:58,647 - INFO - Advanced features:       42
2025-10-30 06:57:58,647 - INFO - ──────────────────────────────
2025-10-30 06:57:58,647 - INFO - TOTAL FEATURES:          99
2025-10-30 06:57:58,647 - INFO - 
2025-10-30 06:57:58,647 - INFO - 3. MEMORY ESTIMATION
2025-10-30 06:57:58,647 - INFO - --------------------------------------------------------------------------------
2025-10-30 06:57:58,647 - INFO - Training data size:     5.80 GB
2025-10-30 06:57:58,647 - INFO -   (15,724,800 rows × 99 features × 4 bytes)
2025-10-30 06:57:58,647 - INFO - Validation split (20%): 1.16 GB
2025-10-30 06:57:58,647 - INFO -   (3,144,960 rows × 99 features × 4 bytes)
2025-10-30 06:57:58,647 - INFO - Test data size:         14.53 GB
2025-10-30 06:57:58,647 - INFO -   (39,398,400 rows × 99 features × 4 bytes)
2025-10-30 06:57:58,647 - INFO - 
2025-10-30 06:57:58,647 - INFO - XGBoost Memory Overhead:
2025-10-30 06:57:58,647 - INFO -   Quantile sketches (max_bin=256): 46.39 MB
2025-10-30 06:57:58,647 - INFO -   Quantile sketches (max_bin=64):  185.58 MB ✅ RECOMMENDED
2025-10-30 06:57:58,647 - INFO -   Thread buffers (nthread=4):      1.74 GB
2025-10-30 06:57:58,647 - INFO -   Thread buffers (nthread=2):      890.78 MB ✅ RECOMMENDED
2025-10-30 06:57:58,647 - INFO - 
2025-10-30 06:57:58,647 - INFO - Estimated Peak Memory Usage:
2025-10-30 06:57:58,647 - INFO -   Current config (defaults):  12.58 GB
2025-10-30 06:57:58,647 - INFO -   Optimized config:           11.85 GB ✅
2025-10-30 06:57:58,647 - INFO -   Available RAM:              16.00 GB
2025-10-30 06:57:58,647 - INFO -   Safe limit (75%):           12.00 GB
2025-10-30 06:57:58,647 - WARNING - ❌ Current config EXCEEDS safe limit by 598.51 MB
2025-10-30 06:57:58,647 - WARNING -    Training will likely crash with OOM!
2025-10-30 06:57:58,647 - INFO - ✅ Optimized config is SAFE (under limit by 153.09 MB)
2025-10-30 06:57:58,647 - INFO - 
2025-10-30 06:57:58,647 - INFO - 4. OVERFITTING RISK ASSESSMENT
2025-10-30 06:57:58,647 - INFO - --------------------------------------------------------------------------------
2025-10-30 06:57:58,648 - INFO - Model complexity:
2025-10-30 06:57:58,648 - INFO -   Max depth:              4
2025-10-30 06:57:58,648 - INFO -   Number of trees:        100
2025-10-30 06:57:58,648 - INFO -   Max leaves per tree:    16
2025-10-30 06:57:58,648 - INFO -   Total leaf nodes:       1,600
2025-10-30 06:57:58,648 - INFO -   Data/parameter ratio:   9,828.0:1
2025-10-30 06:57:58,648 - INFO - ✅ Data/parameter ratio is HIGH (>5000:1)
2025-10-30 06:57:58,648 - INFO -    Lower overfitting risk, but still use regularization
2025-10-30 06:57:58,648 - INFO -   Features per 1K samples: 0.01
2025-10-30 06:57:58,648 - INFO - 
2025-10-30 06:57:58,648 - INFO - Time-series risks:
2025-10-30 06:57:58,648 - INFO -   Training period:        6 months (2023-10-01 to 2024-03-31)
2025-10-30 06:57:58,648 - INFO -   Test period:            24 months (2024-07-01 to 2025-09-30)
2025-10-30 06:57:58,648 - WARNING - ⚠️  Test period is LONGER than training period
2025-10-30 06:57:58,648 - WARNING -    Higher risk of regime shift and distribution drift
2025-10-30 06:57:58,648 - INFO - 
2025-10-30 06:57:58,648 - INFO - Validation strategy:
2025-10-30 06:57:58,648 - INFO - ✅ Dedicated validation set exists
2025-10-30 06:57:58,648 - INFO -    Use for early stopping and hyperparameter tuning
2025-10-30 06:57:58,648 - INFO - 
2025-10-30 06:57:58,648 - INFO - 5. DATA QUALITY CHECKS
2025-10-30 06:57:58,648 - INFO - --------------------------------------------------------------------------------
2025-10-30 06:57:59,138 - WARNING - ⚠️  Found 18 columns with null values in sample:
2025-10-30 06:57:59,139 - WARNING -      expiry_timestamp: 2.9% nulls
2025-10-30 06:57:59,139 - WARNING -      time_to_expiry_seconds: 88.3% nulls
2025-10-30 06:57:59,139 - WARNING -      iv_timestamp: 2.9% nulls
2025-10-30 06:57:59,139 - WARNING -      iv_staleness_seconds: 2.9% nulls
2025-10-30 06:57:59,139 - WARNING -      implied_vol_bid: 3.5% nulls
2025-10-30 06:57:59,139 - WARNING -      implied_vol_ask: 3.5% nulls
2025-10-30 06:57:59,139 - WARNING -      sigma_mid: 3.5% nulls
2025-10-30 06:57:59,139 - WARNING -      T_years: 3.5% nulls
2025-10-30 06:57:59,139 - WARNING -      d2_bid: 3.5% nulls
2025-10-30 06:57:59,139 - WARNING -      d2_ask: 3.5% nulls
2025-10-30 06:57:59,139 - WARNING -      ... and 8 more
2025-10-30 06:57:59,205 - INFO - Date range:
2025-10-30 06:57:59,205 - INFO -   Min date: 2023-10-01
2025-10-30 06:57:59,205 - INFO -   Max date: 2024-03-30
2025-10-30 06:57:59,205 - INFO -   Unique dates: 182
2025-10-30 06:57:59,205 - INFO - 
2025-10-30 06:57:59,205 - INFO - 6. RECOMMENDATIONS
2025-10-30 06:57:59,206 - INFO - ================================================================================
2025-10-30 06:57:59,206 - INFO - 
2025-10-30 06:57:59,206 - INFO - ✅ REQUIRED FIXES (to prevent OOM crash):
2025-10-30 06:57:59,206 - INFO -    1. Set max_bin=64 (reduces quantile sketch memory by 75%)
2025-10-30 06:57:59,206 - INFO -    2. Set nthread=2 (reduces buffer memory by 50%)
2025-10-30 06:57:59,206 - INFO -    3. Set max_cached_hist_node=32 (limits histogram cache)
2025-10-30 06:57:59,206 - INFO -    4. Set ref_resource_aware=True (enables XGBoost memory awareness)
2025-10-30 06:57:59,206 - INFO - 
2025-10-30 06:57:59,206 - INFO - ✅ RECOMMENDED REGULARIZATION (to prevent overfitting):
2025-10-30 06:57:59,206 - INFO -    1. Add early_stopping_rounds=15 (stop when no improvement)
2025-10-30 06:57:59,206 - INFO -    2. Set gamma=25 (minimum loss reduction threshold)
2025-10-30 06:57:59,206 - INFO -    3. Set reg_lambda=50 (L2 regularization)
2025-10-30 06:57:59,206 - INFO -    4. Set reg_alpha=2 (L1 regularization)
2025-10-30 06:57:59,206 - INFO -    5. Set min_child_weight=10 (minimum samples per leaf)
2025-10-30 06:57:59,206 - INFO -    6. Split training data 80/20 for train/validation
2025-10-30 06:57:59,206 - INFO - 
2025-10-30 06:57:59,206 - INFO - ✅ OPTIONAL IMPROVEMENTS:
2025-10-30 06:57:59,206 - INFO -    1. Increase n_estimators to 200 (with early stopping)
2025-10-30 06:57:59,206 - INFO -    2. Use YAML config file for hyperparameter management
2025-10-30 06:57:59,206 - INFO -    3. Monitor validation metrics during training
2025-10-30 06:57:59,206 - INFO -    4. Consider feature selection if memory remains tight
2025-10-30 06:57:59,206 - INFO - 
2025-10-30 06:57:59,206 - INFO - ================================================================================
2025-10-30 06:57:59,206 - INFO - END OF VALIDATION REPORT
2025-10-30 06:57:59,206 - INFO - ================================================================================
